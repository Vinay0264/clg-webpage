<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sri Balaji Educational Institutions</title>
    <link rel="stylesheet" href="apply.css">
    <link rel="stylesheet" href="header.css">
    <link rel="stylesheet" href="footer.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="icon" href="./Images/Favicon.png">
</head>
<body>
    <div id="header"></div>
    <section class="apply">
        <h2>Apply Now</h2>
        <h6>Apply for the course of your choice</h6><br>
        <form id="applicationForm">
            <label>Name of the Student as per 10th Certificate:</label>
            <input type="text" name="student_name" required><br>
            <label>Name of the Father:</label>
            <input type="text" name="father_name" required><br>
            <label>Name of the Mother:</label>
            <input type="text" name="mother_name" required><br>
            <label>Gender:</label>
            <div class="radio-group">
                <input type="radio" id="male" name="gender" value="Male">
                <label for="male">Male</label>
                <input type="radio" id="female" name="gender" value="Female">
                <label for="female">Female</label>
                <input type="radio" id="other" name="gender" value="Other">
                <label for="other">Other</label>
            </div>
            <p id="genderError" class="error-message"></p>
            <label>Date of Birth:</label>
            <input type="date" name="dob" required><br>
            <label>Aadhaar Registered Mobile Number:</label>
            <input type="text" name="student_mobile" required pattern="[0-9]{10}" maxlength="10" minlength="10" title="Mobile number must be 10 digits"
            onkeypress="return event.charCode >= 48 && event.charCode <= 57"><br>
            <label>Alternate Mobile Number:</label>
            <input type="text" name="alternate_mobile" pattern="[0-9]{10}" maxlength="10" minlength="10" title="Mobile number must be 10 digits"
            onkeypress="return event.charCode >= 48 && event.charCode <= 57"><br>
            <label>Email:</label>
            <input type="email" name="email" required><br>
            <label>Address:</label>
            <textarea name="address" required></textarea><br>
            <label>Category:</label>
            <div class="radio-group">
                <input type="radio" id="sc" name="category" value="SC">
                <label for="sc">SC</label>
                <input type="radio" id="st" name="category" value="ST">
                <label for="st">ST</label>
                <input type="radio" id="bc" name="category" value="BC">
                <label for="bc">BC</label>
                <input type="radio" id="oc" name="category" value="OC">
                <label for="oc">OC</label>
            </div>
            <p id="categoryError" class="error-message"></p>
            <label>Name of the Caste:</label>
            <input type="text" name="caste" required><br>
            <label>Religion:</label>
            <div class="radio-group">
                <input type="radio" id="hindu" name="religion" value="Hindu">
                <label for="hindu">Hindu</label>
                <input type="radio" id="christian" name="religion" value="Christian">
                <label for="christian">Christian</label>
                <input type="radio" id="muslim" name="religion" value="Muslim">
                <label for="muslim">Muslim</label>
            </div>
            <p id="religionError" class="error-message"></p>
            <label>Student Aadhaar Card No:</label>
            <input type="text" name="student_aadhaar" required pattern="[0-9]{12}" maxlength="12" minlength="12" title="Aadhaar must be 12 digits"
            onkeypress="return event.charCode >= 48 && event.charCode <= 57"><br>
            <label>Father Aadhaar Card No:</label>
            <input type="text" name="father_aadhaar" required pattern="[0-9]{12}" maxlength="12" minlength="12" title="Aadhaar must be 12 digits"
            onkeypress="return event.charCode >= 48 && event.charCode <= 57"><br>
            <label>Mother Aadhaar Card No:</label>
            <input type="text" name="mother_aadhaar" required pattern="[0-9]{12}" maxlength="12" minlength="12" title="Aadhaar must be 12 digits"
            onkeypress="return event.charCode >= 48 && event.charCode <= 57"><br>
            <label>Guardian Aadhaar Card No: (Optional)</label>
            <input type="text" name="guardian_aadhaar" pattern="[0-9]{12}" maxlength="12" minlength="12" title="Aadhaar must be 12 digits"
            onkeypress="return event.charCode >= 48 && event.charCode <= 57"><br>
            <label>Department:</label><br>
            <div class="radio-group">
                <input type="radio" id="school" name="department" value="school" onclick="updateCourses()">
                <label for="school">School</label>
                <input type="radio" id="inter" name="department" value="inter" onclick="updateCourses()">
                <label for="inter">Intermediate</label>
                <input type="radio" id="degree" name="department" value="degree" onclick="updateCourses()">
                <label for="degree">Degree</label>
            </div>
            <p id="departmentError" class="error-message"></p>
            <div id="courseOptions" class="radio-group"></div>
            <p id="courseError" class="error-message"></p>
            <label>Name of the Previous School/College:</label>
            <input type="text" name="previous_school" required><br>

            <div id="interFields" style="display: none;">
                <label>10th Hall Ticket Number:</label>
                <input type="text" name="tenth_hall_ticket" required 
                pattern="[0-9]{10}" 
                maxlength="10" 
                minlength="10" 
                title="Hall Ticket Number must be 10 digits"
                onkeypress="return event.charCode >= 48 && event.charCode <= 57"><br>
                <label>10th Year of Passing:</label>
                <input type="text" name="tenth_year" required 
                pattern="[0-9]{4}" 
                maxlength="4" 
                minlength="4" 
                title="Year must be 4 digits"
                onkeypress="return event.charCode >= 48 && event.charCode <= 57"><br>
            </div>

            <div id="degreeFields" style="display: none;">
                <label>Inter Hall Ticket Number:</label>
                <input type="text" name="inter_hall_ticket" required 
                pattern="[0-9]{10}" 
                maxlength="10" 
                minlength="10"
                title="Hall Ticket Number must be 10 digits"
                onkeypress="return event.charCode >= 48 && event.charCode <= 57"><br>
                <label>Inter Year of Passing:</label>
                <input type="text" name="inter_year" required 
                pattern="[0-9]{4}" 
                maxlength="4" 
                minlength="4"
                title="Year must be 4 digits"
                onkeypress="return event.charCode >= 48 && event.charCode <= 57"><br>
            </div>
          
            <label>Assisted by: (Optional)</label>
            <input type="text" name="teacher"><br>

            <button type="button" onclick="submitForm()">Apply Now</button>
        </form>
    </section>
    <div id="footer"></div>
    <script src="script.js"> </script>
    <script>
        let radio = `<input type='radio' id='${radioId}' name='course' value='${course}' required>`;
        function updateCourses() {
            let department = document.querySelector('input[name="department"]:checked')?.value;
            let courseOptions = document.getElementById("courseOptions");
            let interFields = document.getElementById("interFields");
            let degreeFields = document.getElementById("degreeFields");

            courseOptions.innerHTML = "";
            interFields.style.display = "none";
            degreeFields.style.display = "none";

            let courses = [];
            if (department === "school") {
                courses = ["Nursery", "LKG", "UKG", "1st", "2nd", "3rd", "4th", "5th", "6th", "7th", "8th", "9th", "10th"];
            } else if (department === "inter") {
                courses = ["MPC", "BiPC", "CEC", "MEC"];
                interFields.style.display = "block";
            } else if (department === "degree") {
                courses = ["BSc Computers", "BSc Chemistry", "BCom Computers", "BCA", "BBA"];
                interFields.style.display = "block";
                degreeFields.style.display = "block";
            }

            courses.forEach(course => {
                let radioId = course.toLowerCase().replace(/\s+/g, "_");
                let radio = `<input type='radio' id='${radioId}' name='course' value='${course}'>`;
                let label = `<label for='${radioId}'>${course}</label>`;
                courseOptions.innerHTML += radio + label;
            });
        }

        function showCustomDialog(message) {
    window.scrollTo({ top: 0, behavior: "smooth" }); // Scroll to the top

    const dialog = document.createElement("div");
    dialog.classList.add("custom-dialog");
    dialog.innerHTML = `
        <div class="dialog-overlay"></div>
        <div class="dialog-box">
            <div class="dialog-header">ðŸŽ‰ Success</div>
            <div class="dialog-body">${message}</div>
            <div class="dialog-footer">
                <button onclick="closeDialog(this)">OK</button>
            </div>
        </div>
    `;
    document.body.appendChild(dialog);
    setTimeout(() => dialog.classList.add("show"), 10);
}

function closeDialog(button) {
    const dialog = button.closest(".custom-dialog");
    dialog.classList.remove("show");
    setTimeout(() => dialog.remove(), 400);
}

function submitForm() {
    var form = document.getElementById("applicationForm");

    // Validate all radio buttons (Department, Gender, Religion, Category, Course)
    let isValid = true;

    isValid &= validateRadio("department", "departmentError", "Please select a department.");
    isValid &= validateRadio("gender", "genderError", "Please select a gender.");
    isValid &= validateRadio("religion", "religionError", "Please select a religion.");
    isValid &= validateRadio("category", "categoryError", "Please select a category.");
    isValid &= validateRadio("course", "courseError", "Please select a course.");

    if (!isValid) {
        return; // Stop form submission
    }

    // Update required attributes dynamically based on department selection
    let department = document.querySelector('input[name="department"]:checked').value;
    updateRequiredFields(department);

    // Check form validity after adjusting required fields
    if (!form.checkValidity()) {
        form.reportValidity(); // Show browser validation messages for other fields
        return;
    }

    // Show loading animation
    showLoading();

    var formData = new FormData(form);

    fetch("https://script.google.com/macros/s/AKfycbwWRY6NAzKpRTLKGXE0Tg0gRSpXRqDJ7OVX2M-dFu2YK6D9xlTm-h-LBfhFLIRpc6OBBA/exec", {
        method: "POST",
        body: formData,
    })
    .then(response => response.text())
    .then(data => {
        hideLoading();
        showCustomDialog("Application submitted successfully!");
        form.reset();
    })
    .catch(error => {
        hideLoading();
        showCustomDialog("Error submitting application: " + error);
    });
}

// Function to validate radio buttons and show error messages
function validateRadio(name, errorId, errorMessage) {
    let selectedOption = document.querySelector(`input[name="${name}"]:checked`);
    let errorElement = document.getElementById(errorId);

    if (!selectedOption) {
        errorElement.textContent = errorMessage;
        errorElement.style.display = "block";
        return false;
    } else {
        errorElement.style.display = "none";
        return true;
    }
}

// Dynamically update required fields based on the department selected
function updateRequiredFields(department) {
    let tenthHallTicket = document.querySelector('input[name="tenth_hall_ticket"]');
    let tenthYear = document.querySelector('input[name="tenth_year"]');
    let interHallTicket = document.querySelector('input[name="inter_hall_ticket"]');
    let interYear = document.querySelector('input[name="inter_year"]');

    // Reset all fields to not required initially
    tenthHallTicket.required = false;
    tenthYear.required = false;
    interHallTicket.required = false;
    interYear.required = false;

    // Apply required attributes based on department
    if (department === "inter") {
        tenthHallTicket.required = true;
        tenthYear.required = true;
    } else if (department === "degree") {
        tenthHallTicket.required = true;
        tenthYear.required = true;
        interHallTicket.required = true;
        interYear.required = true;
    }
}

// Show a loading spinner
function showLoading() {
    const loadingOverlay = document.createElement("div");
    loadingOverlay.id = "loadingOverlay";
    loadingOverlay.innerHTML = `
        <div class="loading-spinner"></div>
        <p>Submitting...</p>
    `;
    document.body.appendChild(loadingOverlay);
}

// Hide the loading spinner
function hideLoading() {
    const loadingOverlay = document.getElementById("loadingOverlay");
    if (loadingOverlay) {
        loadingOverlay.remove();
    }
}
    </script>
</body>
</html>    